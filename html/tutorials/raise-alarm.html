<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Raise alarms - thin-edge.io docs</title>
        <!-- Custom HTML head -->
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../././mdbook-admonish.css">
        <link rel="stylesheet" href="../theme/pagetoc.css">
    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item "><a href="../001_overview.html"><strong aria-hidden="true">1.</strong> Overview</a></li><li class="chapter-item "><a href="../tutorials/getting-started.html"><strong aria-hidden="true">2.</strong> Getting started</a></li><li class="chapter-item "><a href="../architecture/architecture.html"><strong aria-hidden="true">3.</strong> Concepts</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../architecture/faq.html"><strong aria-hidden="true">3.1.</strong> Architecture FAQ</a></li><li class="chapter-item "><a href="../architecture/thin-edge-json.html"><strong aria-hidden="true">3.2.</strong> Thin Edge Json</a></li><li class="chapter-item "><a href="../architecture/mapper.html"><strong aria-hidden="true">3.3.</strong> The Mapper</a></li><li class="chapter-item "><a href="../architecture/software-management.html"><strong aria-hidden="true">3.4.</strong> Software Management</a></li></ol></li><li class="chapter-item expanded "><a href="../tutorials/tutorials.html"><strong aria-hidden="true">4.</strong> Tutorial</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../tutorials/connect-c8y.html"><strong aria-hidden="true">4.1.</strong> Connect my device to Cumulocity IoT</a></li><li class="chapter-item "><a href="../tutorials/connect-azure.html"><strong aria-hidden="true">4.2.</strong> Connect my device to Azure IoT</a></li><li class="chapter-item "><a href="../tutorials/connect-aws.html"><strong aria-hidden="true">4.3.</strong> Connect my device to AWS IoT</a></li><li class="chapter-item "><a href="../tutorials/send-thin-edge-data.html"><strong aria-hidden="true">4.4.</strong> Send measurements</a></li><li class="chapter-item expanded "><a href="../tutorials/raise-alarm.html" class="active"><strong aria-hidden="true">4.5.</strong> Raise alarms</a></li><li class="chapter-item "><a href="../tutorials/send-events.html"><strong aria-hidden="true">4.6.</strong> Send events</a></li><li class="chapter-item "><a href="../tutorials/device-monitoring.html"><strong aria-hidden="true">4.7.</strong> Monitor my device</a></li><li class="chapter-item "><a href="../tutorials/software-management.html"><strong aria-hidden="true">4.8.</strong> Manage my device software</a></li><li class="chapter-item "><a href="../tutorials/child-device-config-management.html"><strong aria-hidden="true">4.9.</strong> Configuration management on child-devices</a></li><li class="chapter-item "><a href="../tutorials/supported_operations.html"><strong aria-hidden="true">4.10.</strong> Supported Operations Management for Cumulocity IoT</a></li><li class="chapter-item "><a href="../tutorials/write-my-software-management-plugin.html"><strong aria-hidden="true">4.11.</strong> Write my software management plugin</a></li><li class="chapter-item "><a href="../tutorials/yocto-linux.html"><strong aria-hidden="true">4.12.</strong> Build Thin Edge for a Yocto Linux distribution</a></li></ol></li><li class="chapter-item "><a href="../howto-guides/howto-guides.html"><strong aria-hidden="true">5.</strong> How-to Guides</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../howto-guides/002_installation.html"><strong aria-hidden="true">5.1.</strong> How to install thin-edge.io?</a></li><li class="chapter-item "><a href="../howto-guides/015_installation_without_deb_support.html"><strong aria-hidden="true">5.2.</strong> How to install thin-edge.io on any Linux OS (no deb support)?</a></li><li class="chapter-item "><a href="../howto-guides/026_how_to_install_thin_edge_manually.html"><strong aria-hidden="true">5.3.</strong> How to install thin-edge manually with openrc</a></li><li class="chapter-item "><a href="../howto-guides/012_install_and_enable_software_management.html"><strong aria-hidden="true">5.4.</strong> How to install and enable software management?</a></li><li class="chapter-item "><a href="../howto-guides/006_config.html"><strong aria-hidden="true">5.5.</strong> How to configure thin-edge.io?</a></li><li class="chapter-item "><a href="../howto-guides/008_config_local_mqtt_bind_address_and_port.html"><strong aria-hidden="true">5.6.</strong> How to configure the local mqtt bind address and port?</a></li><li class="chapter-item "><a href="../howto-guides/010_add_self_signed_trusted.html"><strong aria-hidden="true">5.7.</strong> How to add self-signed certificate root to trusted certificates list?</a></li><li class="chapter-item "><a href="../howto-guides/019_how_to_use_preferred_init_system.html"><strong aria-hidden="true">5.8.</strong> How to use thin-edge.io with your preferred init system</a></li><li class="chapter-item "><a href="../howto-guides/021_enable_tedge_watchdog_using_systemd.html"><strong aria-hidden="true">5.9.</strong> How to enable watchdog using systemd?</a></li><li class="chapter-item "><a href="../howto-guides/018_update_config_paths.html"><strong aria-hidden="true">5.10.</strong> How to change temp path</a></li><li class="chapter-item "><a href="../howto-guides/003_registration.html"><strong aria-hidden="true">5.11.</strong> How to create a test certificate?</a></li><li class="chapter-item "><a href="../howto-guides/004_connect.html"><strong aria-hidden="true">5.12.</strong> How to connect a cloud end-point?</a></li><li class="chapter-item "><a href="../howto-guides/007_test_connection.html"><strong aria-hidden="true">5.13.</strong> How to test the cloud connection?</a></li><li class="chapter-item "><a href="../howto-guides/014_thin_edge_logs.html"><strong aria-hidden="true">5.14.</strong> How to access the logs on the device?</a></li><li class="chapter-item "><a href="../howto-guides/016_restart_device_operation.html"><strong aria-hidden="true">5.15.</strong> How to restart your thin-edge.io device</a></li><li class="chapter-item "><a href="../howto-guides/005_pub_sub.html"><strong aria-hidden="true">5.16.</strong> How to use tedge mqtt module?</a></li><li class="chapter-item "><a href="../howto-guides/013_connect_external_device.html"><strong aria-hidden="true">5.17.</strong> How to connect an external device?</a></li><li class="chapter-item "><a href="../howto-guides/020_monitor_tedge_health.html"><strong aria-hidden="true">5.18.</strong> How to monitor health of tedge daemons</a></li><li class="chapter-item "><a href="../howto-guides/009_trouble_shooting_monitoring.html"><strong aria-hidden="true">5.19.</strong> How to trouble shoot device monitoring?</a></li><li class="chapter-item "><a href="../howto-guides/022_c8y_fragments.html"><strong aria-hidden="true">5.20.</strong> How to add custom fragments to Cumulocity</a></li><li class="chapter-item "><a href="../howto-guides/023_c8y_log_plugin.html"><strong aria-hidden="true">5.21.</strong> How to retrieve logs with the log plugin</a></li><li class="chapter-item "><a href="../howto-guides/024_smartrest_templates.html"><strong aria-hidden="true">5.22.</strong> How to add C8Y SmartRest Templates</a></li><li class="chapter-item "><a href="../howto-guides/025_config_management_plugin.html"><strong aria-hidden="true">5.23.</strong> How to manage configuration files with Cumulocity</a></li><li class="chapter-item "><a href="../howto-guides/child_device_config_management_agent.html"><strong aria-hidden="true">5.24.</strong> How to enable configuration management on child devices</a></li><li class="chapter-item "><a href="../howto-guides/child_device_firmware_management.html"><strong aria-hidden="true">5.25.</strong> How to enable firmware management on child devices</a></li><li class="chapter-item "><a href="../howto-guides/027_remote_access_with_cumulocity.html"><strong aria-hidden="true">5.26.</strong> How to remotely connect to your thin-edge.io device via SSH/VNC/Telnet with Cumulocity remote access</a></li><li class="chapter-item "><a href="../howto-guides/028_c8y_service_monitoring.html"><strong aria-hidden="true">5.27.</strong> How to monitor a service from Cumulocity</a></li><li class="chapter-item "><a href="../howto-guides/017_apama_software_management_plugin.html"><strong aria-hidden="true">5.28.</strong> How to manage Apama software artifacts with Apama plugin?</a></li><li class="chapter-item "><a href="../howto-guides/011_retrieve_jwt_token_from_cumulocity.html"><strong aria-hidden="true">5.29.</strong> How to retrieve JWT token from Cumulocity?</a></li></ol></li><li class="chapter-item "><a href="../references/references.html"><strong aria-hidden="true">6.</strong> Reference</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../supported-platforms.html"><strong aria-hidden="true">6.1.</strong> Supported platforms</a></li><li class="chapter-item "><a href="../references/thin-edge-config-files.html"><strong aria-hidden="true">6.2.</strong> Thin-edge.io configuration files</a></li><li class="chapter-item "><a href="../references/bridged-topics.html"><strong aria-hidden="true">6.3.</strong> MQTT bridge configuration</a></li><li class="chapter-item "><a href="../references/init-system-config.html"><strong aria-hidden="true">6.4.</strong> Init System Configuration File</a></li><li class="chapter-item "><a href="../references/tedge.html"><strong aria-hidden="true">6.5.</strong> tedge command</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../references/tedge-cert.html"><strong aria-hidden="true">6.5.1.</strong> tedge cert command</a></li><li class="chapter-item "><a href="../references/tedge-config.html"><strong aria-hidden="true">6.5.2.</strong> tedge config command</a></li><li class="chapter-item "><a href="../references/tedge-connect.html"><strong aria-hidden="true">6.5.3.</strong> tedge connect command</a></li><li class="chapter-item "><a href="../references/tedge-disconnect.html"><strong aria-hidden="true">6.5.4.</strong> tedge disconnect command</a></li><li class="chapter-item "><a href="../references/tedge-mqtt.html"><strong aria-hidden="true">6.5.5.</strong> tedge mqtt command</a></li></ol></li><li class="chapter-item "><a href="../architecture/domain-model.html"><strong aria-hidden="true">6.6.</strong> Domain Model</a></li><li class="chapter-item "><a href="../architecture/data-model.html"><strong aria-hidden="true">6.7.</strong> Data Model</a></li><li class="chapter-item "><a href="../BUILDING.html"><strong aria-hidden="true">6.8.</strong> Building</a></li><li class="chapter-item "><a href="../references/plugin-api.html"><strong aria-hidden="true">6.9.</strong> Plugin API</a></li><li class="chapter-item "><a href="../references/c8y-log-management.html"><strong aria-hidden="true">6.10.</strong> Log Management</a></li><li class="chapter-item "><a href="../references/c8y-configuration-management.html"><strong aria-hidden="true">6.11.</strong> Configuration Management</a></li><li class="chapter-item "><a href="../references/tedge-file-transfer-service.html"><strong aria-hidden="true">6.12.</strong> Thin Edge File Transfer Service</a></li></ol></li><li class="chapter-item "><a href="../SUMMARY.html"><strong aria-hidden="true">7.</strong> Index</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">thin-edge.io docs</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main><div class="sidetoc"><nav class="pagetoc"></nav></div>
                        <h1 id="thin-edge-alarm"><a class="header" href="#thin-edge-alarm">Thin Edge Alarm</a></h1>
<p>Alarms on thin-edge.io can be used to create alerts, represent state changes etc.
For example, an alarm can be raised when a certain measurement value breaches some threshold (like high temperature) or when an unexpected event occurs in the system (like a sensor failure).</p>
<p>A typical alarm cycle starts by the raising of an alarm by some monitoring process which alerts a system/human of an event needing some action.
Once some action is taken, the alarm is cleared explicitly by that system/human.</p>
<p>Every alarm is uniquely identified by its type and severity.
That is, for a given alarm type, alarms of varying severities are treated as independent alarms and hence, must be acted upon separately.
For an alarm of a given type and severity, only the last known state is considered relevant.
Thin-edge.io doesn't keep a history of all its state changes but only reacts to the last one it receives.</p>
<h2 id="raising-an-alarm"><a class="header" href="#raising-an-alarm">Raising an alarm</a></h2>
<p>An alarm can be raised on thin-edge.io by sending an MQTT message in Thin Edge JSON format to certain MQTT topics.</p>
<p>The scheme of the topic to publish the alarm data is as follows:</p>
<p><code>tedge/alarms/&lt;severity&gt;/&lt;alarm-type&gt;</code></p>
<p>The payload format must be as follows:</p>
<pre><code class="language-json">{
    &quot;text&quot;: &quot;&lt;alarm text&gt;&quot;,
    &quot;time&quot;: &quot;&lt;Timestamp in ISO-8601 format&gt;&quot;
}
</code></pre>
<div id="admonition-note" class="admonition note">
<div class="admonition-title">
<p>Note</p>
<p><a class="admonition-anchor-link" href="#admonition-note"></a></p>
</div>
<div>
<p>These messages must be sent with MQTT retained flag enabled and with QOS &gt; 1 to ensure guaranteed processing by thin-edge.io.
Enabling the retained flag ensures that the alarm stays persisted with the MQTT broker until its state changes again.
These retained messages will make sure that the thin-edge.io processes or any other third-party processes subscribed to these alarms will get those,
even if they were down at the moment the alarm was raised.
If multiple messages are sent to the same alarm topic, the last alarm is considered to have overwritten the previous one.</p>
</div>
</div>
<p>Here is a sample alarm raised for <code>temperature_high</code> alarm type with <code>critical</code> severity:</p>
<p>Topic: 
<code>tedge/alarms/critical/temperature_high</code></p>
<p>Payload:</p>
<pre><code class="language-json">{
    &quot;text&quot;: &quot;Temperature is very high&quot;,
    &quot;time&quot;: &quot;2021-01-01T05:30:45+00:00&quot;
}
</code></pre>
<div id="admonition-note-1" class="admonition note">
<div class="admonition-title">
<p>Note</p>
<p><a class="admonition-anchor-link" href="#admonition-note-1"></a></p>
</div>
<div>
<p>Both the <code>text</code> field and the <code>time</code> field are optional.
When a <code>text</code> is not provided, it is assumed to be empty.
When <code>time</code> is not provided, thin-edge.io will use the current system time as the <code>time</code> of the alarm.
When you want to skip both fields, use an empty json fragment <code>{}</code> as the payload to indicate the same.
An empty message can't be used for the same, as empty messages are used to clear alarms, which is discussed in the next section.</p>
</div>
</div>
<p>The <code>&lt;severity&gt;</code> value in the MQTT topic can only be one of the following values:</p>
<ol>
<li>critical</li>
<li>major</li>
<li>minor</li>
<li>warning</li>
</ol>
<p>There are no such restrictions on the <code>&lt;alarm-type&gt;</code> value.</p>
<p>Thin-edge.io doesn't keep any history of all alarms raised on an alarm topic.</p>
<h2 id="clearing-alarms"><a class="header" href="#clearing-alarms">Clearing alarms</a></h2>
<p>An already raised alarm can be cleared by sending an empty message with retained flag enabled to the same alarm topic on which the original alarm was raised.</p>
<p>For example <code>temperature_alarm</code> will be cleared by publishing an empty payload message as below:</p>
<pre><code>tedge mqtt pub tedge/alarms/critical/temperature_alarm &quot;&quot; -q 2 -r
</code></pre>
<div id="admonition-note-2" class="admonition note">
<div class="admonition-title">
<p>Note</p>
<p><a class="admonition-anchor-link" href="#admonition-note-2"></a></p>
</div>
<div>
<p>Using the retained (-r) flag is a must while clearing the alarm as well, without which the alarm won't be cleared properly.</p>
</div>
</div>
<p>If alarms of different severities exist for a given alarm type, they must all be cleared separately as they're all treated as independent alarms.</p>
<h3 id="raising-alarms-from-child-devices"><a class="header" href="#raising-alarms-from-child-devices">Raising alarms from child devices</a></h3>
<p>Alarms for child devices can be raised by publishing the alarm payload to <code>tedge/alarms/&lt;severity&gt;/&lt;alarm-type&gt;/&lt;child-device-id&gt;</code> topic,
where the <code>child-device-id</code> is the unique device id of the child device.
The alarm payload structure is the same, as described in the previous section.</p>
<h3 id="raising-an-alarm-with-custom-fragment"><a class="header" href="#raising-an-alarm-with-custom-fragment">Raising an alarm with custom fragment</a></h3>
<p>Thin-edge supports the creation of alarms using custom (user-defined) fragments.
Custom fragments are supported for both the main and child devices.
The custom fragments can be a simple json value or a complex json value.</p>
<p>For example, an alarm with simple custom fragment field named <code>details</code>:</p>
<p>Payload:</p>
<pre><code class="language-json">{
    &quot;text&quot;: &quot;Temperature is very high&quot;,
    &quot;time&quot;: &quot;2021-01-01T05:30:45+00:00&quot;,
    &quot;details&quot;: &quot;A custom alarm info&quot;
}
</code></pre>
<p>For example, an alarm with complex custom fragments</p>
<p>Payload:</p>
<pre><code class="language-json">{
    &quot;text&quot;: &quot;Temperature is very high&quot;,
    &quot;time&quot;: &quot;2021-01-01T05:30:45+00:00&quot;,
    &quot;someOtherCustomFragment&quot;: {
        &quot;nested&quot;: {
            &quot;value&quot;: &quot;extra info&quot;
        }
    }
}
</code></pre>
<div id="admonition-note-3" class="admonition note">
<div class="admonition-title">
<p>Note</p>
<p><a class="admonition-anchor-link" href="#admonition-note-3"></a></p>
</div>
<div>
<p>Other than <code>text</code> and <code>time</code> fields, all the other fields are considered as custom fragments.</p>
</div>
</div>
<h3 id="raising-an-alarm-with-empty-json-payload"><a class="header" href="#raising-an-alarm-with-empty-json-payload">Raising an alarm with empty json payload</a></h3>
<p>Alarms can also be raised with an <code>empty json object</code> as payload as follows:</p>
<p>Payload:</p>
<pre><code class="language-json">{}
</code></pre>
<div id="admonition-note-4" class="admonition note">
<div class="admonition-title">
<p>Note</p>
<p><a class="admonition-anchor-link" href="#admonition-note-4"></a></p>
</div>
<div>
<p>The <code>default</code> value for the <code>time</code> fragment will be the timestamp in utc time that is added by the <code>tedge-mapper-c8y</code>
while alarm message being translated to cumulocity format.
The default value for the <code>text</code> fragment will be derived from the <code>alarm-type</code> of the topic.</p>
</div>
</div>
<h2 id="cloud-data-mapping"><a class="header" href="#cloud-data-mapping">Cloud data mapping</a></h2>
<p>If the device is connected to some supported IoT cloud platform, any alarms raised locally on thin-edge.io will be forwarded to the connected cloud platform as well.
The mapping of thin-edge alarms data to its respective cloud-native representation will be done by the corresponding cloud mapper process.
For example, if the device is connected to Cumulocity IoT cloud platform, the Cumulocity cloud mapper process will translate the thin-edge alarm JSON data to its equivalent Cumulocity SmartREST representation.</p>
<div id="admonition-warning" class="admonition warning">
<div class="admonition-title">
<p>Warning</p>
<p><a class="admonition-anchor-link" href="#admonition-warning"></a></p>
</div>
<div>
<p>As of now, alarm data mapping is supported only on Cumulocity IoT cloud platform.</p>
</div>
</div>
<h3 id="cumulocity-cloud-data-mapping"><a class="header" href="#cumulocity-cloud-data-mapping">Cumulocity cloud data mapping</a></h3>
<p>The Cumulocity mapper will convert Thin Edge JSON alarm into Cumulocity SmartREST messages and send it to Cumulocity via MQTT.</p>
<p>For example the <code>temperature_high</code> alarm with <code>critical</code> severity described in the earlier sections will be converted to the following Cumulocity SmartREST message:</p>
<pre><code class="language-csv">301,temperature_high,&quot;Temperature is very high&quot;,2021-01-01T05:30:45+00:00
</code></pre>
<p>... and is published to <code>c8y/s/us</code> topic which will get forwarded to the connected Cumulocity cloud instance.</p>
<p>If the alarm is raised from a child device, the payload is published to <code>c8y/s/us/&lt;child-device-id&gt;</code> topic instead.</p>
<p>If an alarm contains a <code>custom fragment</code> then, the alarm message will be converted to <code>cumulocity json</code>
format and then will be published on to <code>c8y/alarm/alarms/create</code> topic.</p>
<p>An example of the translated custom message for <code>thin-edge</code> device will be as below</p>
<pre><code class="language-json">{
    &quot;severity&quot;:&quot;MAJOR&quot;,
    &quot;type&quot;:&quot;temperature_high&quot;,
    &quot;time&quot;:&quot;2023-01-25T18:41:14.776170774Z&quot;,
    &quot;text&quot;:&quot;Temperature High&quot;,
    &quot;someOtherCustomFragment&quot;:
        {
            &quot;nested&quot;:
            {
                &quot;value&quot;: &quot;extra info&quot;
            }
        }
}
</code></pre>
<p>An example of the translated <code>cumulocity</code> alarm message for a <code>child</code> device with a <code>custom</code> fragment will be as below</p>
<pre><code class="language-json">{
    &quot;severity&quot;:&quot;MAJOR&quot;,
    &quot;type&quot;:&quot;pressure_alarm&quot;,
    &quot;time&quot;:&quot;2023-01-25T18:41:14.776170774Z&quot;,
    &quot;text&quot;:&quot;Pressure alarm&quot;,
    &quot;someOtherCustomFragment&quot;:
        {
            &quot;nested&quot;:
            {
                &quot;value&quot;: &quot;extra info&quot;
            }
        }
    &quot;externalSource&quot;:
        {
            &quot;externalId&quot;:&quot;child_device_id&quot;,
            &quot;type&quot;:&quot;c8y_Serial&quot;
        }
}

</code></pre>
<p>Find more information about SmartREST representations for alarms in Cumulocity <a href="https://cumulocity.com/guides/10.11.0/reference/smartrest-two/#alarm-templates">here</a></p>
<p>Find more information about alarms data model in Cumulocity <a href="https://cumulocity.com/guides/concepts/domain-model/#events">here</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../tutorials/send-thin-edge-data.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../tutorials/send-events.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../tutorials/send-thin-edge-data.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../tutorials/send-events.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script>
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>
        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../mermaid.min.js"></script>
        <script src="../mermaid-init.js"></script>
        <script src="../theme/pagetoc.js"></script>
    </div>
    </body>
</html>
